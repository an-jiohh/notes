
# **대칭키(HMAC) 방식 vs 비대칭키(RSA, ECDSA) 방식**

  

JWT는 발급된 토큰의 위·변조를 방지하기 위해 Signature(서명) 영역을 사용함.

서명은 토큰의 Header와 Payload를 바탕으로 계산되며, 이때 사용하는 알고리즘에 따라 **대칭키 방식**과 **비대칭키 방식**으로 나뉨.

각 방식은 보안성과 사용 방식에서 중요한 차이가 존재함.

---

## **대칭키 방식 (HMAC 계열)**

### MAC(message authentication code)

송수진자 간의 메시지를 주고 받을 때 메시지가 변조되었는지 확인하기 위한 방법
원본 메시지와 전달된 메시지를 비교하여 변조 여부를 판단

### HMAC(hash-based message authentication code)

Hash를 이용한 MAC 구현 방법

대칭키 방식은 **하나의 비밀 키(secret key)** 를 사용하여 서명과 검증을 모두 수행하는 방식으로
대칭키 방식을 사용하여 메시지의 변조여부를 판단

JWT에서는 주로 HS256, HS384, HS512와 같은 알고리즘으로 구현됨.
  

### **특징**

- 서명 생성과 검증에 동일한 키 사용
    
- 키 길이에 따라 보안 수준 설정 가능 (예: HS256은 256비트 키 권장)
    
- 알고리즘이 단순하고 성능이 뛰어남
    
- 키가 유출될 경우 모든 토큰이 위·변조 가능해짐
    

  

### **예시 알고리즘**

- HS256 (HMAC + SHA-256)
    
- HS384, HS512 (SHA-384/512 기반 확장)
    

  

### **장점**

- 구조가 단순하고 구현이 쉬움
    
- 검증 속도가 빠르며 CPU 부담이 적음
    
- 키 관리가 단일화되어 운영이 간단함
    

  

### **단점**

- 발급자와 검증자가 반드시 동일한 키를 공유해야 함
    
- 비밀 키가 노출되면 토큰 위조 가능
    
- 다양한 서비스 또는 제3자와 공유하기에는 부적합
    

---

## **비대칭키 방식 (RSA, ECDSA 계열)**

  

비대칭키 방식은 **개인 키(private key)**로 서명을 생성하고, **공개 키(public key)**로 검증을 수행하는 방식.

JWT에서는 RS256, RS384, RS512, ES256 등 다양한 알고리즘을 지원함.

  

### **특징**

- 서명과 검증에 서로 다른 키 사용
    
- 공개키를 외부에 배포하더라도 서명 생성은 불가능
    
- 개인키는 서버에서만 보관하고, 공개키는 여러 시스템에 배포 가능
    

  

### **예시 알고리즘**

- RS256 (RSA + SHA-256)
    
- ES256 (ECDSA + SHA-256)
    
- PS256 (RSA-PSS + SHA-256, 보안 강화 버전)
    

  

### **장점**

- 서명 주체와 검증 주체를 분리 가능
    
- 공개키 기반이므로 서비스 간 연동, 외부 시스템과의 통합에 유리
    
- 키 유출 가능성이 낮고, 검증 로직의 신뢰성 향상
    

  

### **단점**

- 서명 생성 및 검증 시 계산량이 많아 상대적으로 느림
    
- 키 길이가 길어져 토큰 크기가 커짐
    
- RSA는 키 길이에 따라 보안성과 성능 간 트레이드오프 존재
    

---

## **비교 요약**

|**항목**|**대칭키 방식 (HMAC)**|**비대칭키 방식 (RSA, ECDSA)**|
|---|---|---|
|키 개수|1개 (secret key)|2개 (private + public key)|
|서명 주체|동일한 키 사용|private key|
|검증 주체|동일한 키 사용|public key|
|성능|빠름|느림 (RSA), 중간 (ECDSA)|
|보안성|키 유출 시 전체 위험|개인키만 유출되지 않으면 안전|
|활용 범위|단일 시스템, 내부 인증용|외부 연동, 제3자 인증용|
|JWT 알고리즘|HS256, HS512 등|RS256, ES256, PS256 등|
|구현 난이도|낮음|중간 이상|
|토큰 크기|작음|큼 (서명 길이 차이)|

---

## **실무 선택 기준**

|**상황**|**추천 방식**|
|---|---|
|단일 서버 또는 내부 인증|대칭키 방식 (HS256)|
|외부 시스템과의 연동 필요|비대칭키 방식 (RS256, ES256)|
|OAuth2 / OpenID Connect 기반 인증 서버|비대칭키 방식 필수|
|높은 성능 요구, 키 관리 간소화 우선|대칭키 방식 유리|
|높은 보안성, 신뢰 분산 필요|비대칭키 방식 권장|

---

## **마무리**

  

JWT에서 서명 방식 선택은 시스템 구조, 보안 요구사항, 서비스 확장성 등에 따라 달라짐.

**대칭키 방식은 간단하고 빠르지만 키 관리에 주의가 필요하며**,

**비대칭키 방식은 복잡하지만 신뢰성과 보안성에서 더 유리한 구조**를 제공함.

  

실무에서는 다음 요소를 기준으로 알고리즘을 선택하는 것이 바람직함.

1. 외부 서비스와 연동 여부
2. JWT를 검증할 주체 수
3. 토큰의 유통 범위
4. 보안 위협 모델에 따른 키 노출 리스크
  

JWT의 장점을 극대화하기 위해서는 단순히 알고리즘을 선택하는 것이 아니라, **토큰 설계와 키 관리 전략까지 함께 고려하는 것이 필요**함.