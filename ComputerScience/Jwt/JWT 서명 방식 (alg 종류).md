
# **JWT 서명 방식과 alg 종류 정리**

  

JWT(JSON Web Token)는 토큰의 위·변조를 방지하기 위해 서명(Signature) 영역을 포함함.

이 서명은 alg(algorithm) 필드를 통해 어떤 알고리즘으로 생성되었는지를 명시하며, 서버는 이 정보를 기반으로 서명을 검증함.

alg 필드는 JWT Header에 포함되며, 토큰의 신뢰성을 확보하는 핵심 요소로 작용함.

---

## **서명 방식 분류**

  

JWT에서 사용할 수 있는 서명 알고리즘은 크게 세 가지 방식으로 분류됨.

  

### **1. 대칭키 기반 (HMAC)**

- 서명 생성과 검증에 동일한 비밀 키 사용
    
- 단일 시스템 또는 내부 인증 구조에 적합
    
- 알고리즘 접두어: HS (HMAC + SHA)
    

|**알고리즘**|**해시 함수**|**키 유형**|**특징**|
|---|---|---|---|
|HS256|SHA-256|secret key|가장 많이 사용되는 기본값|
|HS384|SHA-384|secret key|보안 강화 목적|
|HS512|SHA-512|secret key|대용량 보안 요구 환경에 적합|

### **2. 비대칭키 기반 (RSA)**

- 개인 키로 서명 생성, 공개 키로 검증 수행
    
- 발급자와 검증자가 분리된 구조에 적합
    
- 알고리즘 접두어: RS (RSA + SHA)
    

|**알고리즘**|**해시 함수**|**키 유형**|**특징**|
|---|---|---|---|
|RS256|SHA-256|private/public key|가장 널리 사용되는 비대칭 알고리즘|
|RS384|SHA-384|private/public key|중간 수준의 보안 요구|
|RS512|SHA-512|private/public key|고보안, 고부하 환경용|

### **3. 타원 곡선 기반 (ECDSA)**

- ECC(Elliptic Curve Cryptography)를 이용한 서명
    
- RSA보다 짧은 키 길이로 동일 수준의 보안성 확보 가능
    
- 알고리즘 접두어: ES (ECDSA + SHA)
    

|**알고리즘**|**해시 함수**|**키 유형**|**특징**|
|---|---|---|---|
|ES256|SHA-256|EC private/public key|OAuth2 및 고성능 인증 구조에서 사용|
|ES384|SHA-384|EC private/public key|보안과 성능의 균형|
|ES512|SHA-512|EC private/public key|고보안 시스템 대상|

### **4. RSA-PSS 기반**

- RSA의 보안성을 강화한 서명 방식
    
- padding 방식 변경으로 공격 가능성 줄임
    
- 알고리즘 접두어: PS (RSA-PSS + SHA)
    

|**알고리즘**|**해시 함수**|**키 유형**|**특징**|
|---|---|---|---|
|PS256|SHA-256|private/public key|보안 강화, RSA의 대체안으로 사용 증가|
|PS384|SHA-384|private/public key|중간 수준|
|PS512|SHA-512|private/public key|고보안, 공공 시스템 등에서 사용 가능|

---

## **none 알고리즘 주의사항**

  

JWT는 alg: none이라는 알고리즘도 허용함. 이는 서명 없이 Payload를 전달하는 옵션으로, 테스트 용도로만 사용되어야 함.

```
{
  "alg": "none",
  "typ": "JWT"
}
```

- 실무에서는 절대 사용 금지
    
- 일부 라이브러리나 취약한 설정에서는 none을 허용하는 경우가 있어 보안 사고 가능성 존재
    
- 인증 시스템에서는 해당 알고리즘을 반드시 차단하거나 검증 로직에 포함시켜야 함
    

---

## **JWT Header 예시**

```
{
  "alg": "RS256",
  "typ": "JWT",
  "kid": "key-2024-v1"
}
```

- alg: 서명 방식 지정
    
- typ: 토큰 타입 명시
    
- kid: 키를 식별하기 위한 ID (비대칭키 또는 키 로테이션 환경에서 사용)
    

---

## **실무 선택 기준**

|**조건**|**권장 알고리즘**|
|---|---|
|단일 시스템, 성능 우선|HS256|
|외부 검증 필요, 공개키 배포|RS256 또는 ES256|
|OAuth2, OpenID Connect 기반|RS256 또는 ES256|
|고보안 환경, 규제 대상 시스템|PS256, ES384, RS512 등|
|공개 서비스, 제3자 토큰 공유|비대칭키 계열 필수 사용|

---

## **마무리**

  

JWT의 alg 값은 단순한 옵션이 아니라 보안 구조 전체를 결정짓는 핵심 요소.

적절한 알고리즘 선택과 함께 키 관리 전략, 서명 검증 로직까지 통합적으로 설계하는 것이 필수.

특히 alg: none에 대한 취약점 방지, 라이브러리의 기본 설정 확인, 비대칭키 환경에서의 kid 필드 활용 등은 실무에서 반드시 체크해야 할 항목.

장단점을 조금 더 조사할 필요가 있어보임