
# **JWT에서 유효성 검증이 필요한 이유**

  

JWT는 구조적으로 서명 기반의 자가 포함(Self-contained) 토큰으로

토큰에 있는 payload를 확인한 후 이를 바탕으로 비즈니스 로직을 처리함  
즉, 서버는 외부 저장소를 참조하지 않고 토큰 내부 정보만으로 사용자 인증과 권한 처리를 수행할 수 있음

그러나 이 구조만으로는 보안이 보장되지 않으며, **토큰이 유효한지 판단하기 위한 검증 절차가 필수적**

---

# **JWT 유효성 검증 요약**

|**검증 항목**|**관련 필드**|**검증 목적**|**검사 방식 요약**|
|---|---|---|---|
|서명(Signature)|Header + Payload + Signature|위·변조 방지|서버에서 비밀키(secret) 또는 공개키(public key)로 서명 재계산 후 일치 여부 비교|
|만료 시간(exp)|Payload의 exp|유효 기간 초과 여부 판단|현재 시간(now()) > exp이면 만료 처리|
|발급자(iss)|Payload의 iss|발급 주체 검증|설정한 허용 발급자 리스트와 비교|
|수신 대상자(aud)|Payload의 aud|사용할 수 있는 대상 시스템인지 확인|현재 API 서버의 식별자와 일치하는지 비교|
|사용 가능 시점(nbf)|Payload의 nbf|사용 가능 시작 시각 이전 요청 차단|현재 시간 < nbf일 경우 사용 불가|
|발급 시간(iat)|Payload의 iat|토큰 재발급 정책, 클라이언트 시간 보정 등|클라이언트 기준 시간 계산에 활용|
|사용자 식별(sub)|Payload의 sub|사용자 ID 등 토큰의 주체 확인|내부 사용자 DB와 매핑하거나 ID 추출용|
|권한/역할(role, scope)|Payload의 커스텀 클레임|리소스 접근 제어(인가)|요청 리소스의 접근 조건과 비교|
|알고리즘 유형|Header의 alg|허용된 서명 방식 여부 확인|alg 값이 설정된 허용 목록 내에 포함되는지 검증|
|키 식별자(kid)|Header의 kid|올바른 키 선택|kid 값에 따라 키 로테이션에서 적절한 키 선택|


---

## **1. 서명 위·변조 방지**

  

JWT는 발급 이후 누구나 Payload를 디코딩할 수 있음

따라서 악의적인 사용자가 Payload 내용을 수정하고 다시 서버에 전송할 수 있음

  

### **검증 필요성**

- JWT는 서명을 통해 Payload가 위변조되지 않았음을 증명
    
- 서버는 서명 검증을 통해 토큰이 **발급 당시의 상태와 동일함**을 확인
    

  

### **결과**

- 서명이 올바르지 않으면 인증 실패 처리
    
- 서버는 401 Unauthorized 또는 403 Forbidden 응답 반환
    

---

## **2. 만료된 토큰 차단**

  

JWT는 클라이언트가 보관하고 있기 때문에, 만료 이후에도 그대로 전송될 수 있음

자동 삭제되는 구조가 아니므로, **유효 시간 판단은 항상 서버의 책임**

  

### **검증 필요성**

- exp 클레임을 확인하여 유효 기간 초과 여부 판단
    
- 만료된 토큰은 즉시 폐기하고 재인증 요구
    

  

### **결과**

- Access Token 만료 → Refresh Token으로 갱신 유도
    
- 재인증 요구 또는 강제 로그아웃 처리
    

---

## **3. 알고리즘 위조 방지**

  

JWT는 alg 필드에 알고리즘을 지정할 수 있음

일부 라이브러리에서는 잘못된 설정으로 인해 alg: none이나 위조된 알고리즘을 허용할 수 있음

  

### **검증 필요성**

- 허용된 알고리즘 목록 이외는 차단
    
- 서버는 Header의 alg 값을 검증 대상에 포함
    

  

### **결과**

- 예상치 못한 알고리즘 사용 시 즉시 토큰 거부
    
- 내부 인증 정책의 일관성 유지
    

---

## **4. 발급자와 수신자 일치 확인**

  

JWT는 iss(issuer)와 aud(audience) 클레임을 통해 발급자와 수신 대상을 구분할 수 있음

다른 시스템에서 발급된 토큰을 오용할 가능성 존재

  

### **검증 필요성**

- iss, aud 값을 통해 토큰이 본 시스템용인지 확인
    
- 타 시스템에서 발급된 토큰의 오용 방지
    

  

### **결과**

- 잘못된 발급자 또는 수신 대상 → 인증 거부
    
- 시스템 간 통신 또는 연동 API 보안 확보
    

---

## **5. 권한 오용 방지**

  

Payload에 포함된 역할(role), 범위(scope) 등의 클레임은 인가(Authorization)에 사용됨

하지만 이 정보 역시 위변조 가능성이 있으므로 반드시 신뢰할 수 있는 상태인지 확인 필요

  

### **검증 필요성**

- 사용자 권한 정보는 신뢰 가능한 서명 아래서만 사용
    
- 클레임 해석 시 sub, role, scope 등 필드에 대한 조건 검증 포함
    

  

### **결과**

- 잘못된 권한 정보 포함된 토큰 → 인가 실패 처리
    
- 클레임 기반 접근 제어 시 오용 방지
    

---

## **실무에서의 유효성 검증 흐름**

|**검증 항목**|**목적**|
|---|---|
|서명(Signature)|위·변조 방지|
|만료 시간(exp)|토큰 수명 확인|
|발급자(iss)|발급 주체 검증|
|수신자(aud)|사용 대상 제한|
|역할/권한|인가 판단 근거|

---

## **마무리**

  

JWT는 구조적으로 매우 유연하고 효율적인 인증 수단이지만,

**검증 없이 신뢰할 수 있는 구조는 아님**

항상 서버에서 다음 조건을 기준으로 유효성 검증을 수행해야 보안성과 신뢰성을 유지할 수 있음

- 서명 검증
    
- 만료 확인
    
- 발급자 및 수신자 검증
    
- 권한 정보 정합성 확인
    
- 알고리즘 위조 대응
    

  

이러한 검증 과정을 빠짐없이 수행하는 것이 **JWT 인증의 핵심 설계 원칙**

